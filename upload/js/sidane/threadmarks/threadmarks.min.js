!function(o,e,t,r){o.tools.tooltip.addEffect("RightPreviewTooltip",function(t){var r=this.getTrigger().offset(),i=this.getConf(),a={top:"auto",bottom:o(e).height()-r.top+i.offset[0]},n=o(e).width()<480;n?a.left=Math.min(50,r.left+i.offset[1]):(a.right=o("html").width()-this.getTrigger().outerWidth()-r.left-i.offset[1],a.left="auto");var l=this.getTip();l.css(a);var d=o(e).scrollTop()-r.top+i.offset[0]+l.outerHeight();if(d>=0&&l.css({top:r.top+i.offset[0]+this.getTrigger().outerHeight(),bottom:"auto"}),!n){var s=l.find(".arrow");d>=0?s.hide():s.css({left:l.width()-i.offset[1]-s.outerWidth(),top:"auto"})}l.xfFadeIn(XenForo.speed.normal)},function(o){this.getTip().xfFadeOut(XenForo.speed.fast)}),XenForo.RightPreviewTooltip=function(e){var r,i,a;if(parseInt(XenForo._enableOverlays)){if(!(i=e.data("previewurl")))return void console.warn("Preview tooltip has no preview: %o",e);e.find("[title]").andSelf().attr("title",""),e.bind({mouseenter:function(n){r||(a=setTimeout(function(){if(!r){r=!0;var a,n,l=o("#PreviewTooltip");if(!l.length)return void console.error("Unable to find #PreviewTooltip");console.log("Setup preview tooltip for %s",i),a=l.clone().removeAttr("id").addClass("xenPreviewTooltip").appendTo(t.body),XenForo._PreviewTooltipCache[i]||(n=XenForo.ajax(i,{},function(e){XenForo.hasTemplateHtml(e)?(XenForo._PreviewTooltipCache[i]=e.templateHtml,o(e.templateHtml).xfInsert("replaceAll",a.find(".PreviewContents"))):a.remove()},{type:"GET",error:!1,global:!1})),e.tooltip(XenForo.configureTooltipRtl({predelay:500,delay:0,effect:"RightPreviewTooltip",fadeInSpeed:"normal",fadeOutSpeed:"fast",tip:a,position:"bottom right",offset:[10,15]})),e.data("tooltip").show(0),XenForo._PreviewTooltipCache[i]&&o(XenForo._PreviewTooltipCache[i]).xfInsert("replaceAll",a.find(".PreviewContents"),"show",0)}},800))},mouseleave:function(o){return r?void(e.data("tooltip")&&e.data("tooltip").hide()):void(a&&clearTimeout(a))},mousedown:function(o){a&&clearTimeout(a),e.data("tooltip")&&e.data("tooltip").hide()}})}},XenForo.ThreadmarkSortable=function(e){function t(o){for(var e in o){var r=o[e];"li_attr"==e||"a_attr"==e||"icon"==e||"data"==e||"text"==e?delete o[e]:"object"==typeof r&&t(r)}}var r=e.data("sort-url");return r?(o(".fa-lock").show(),o(".fa-unlock").click(function(){location.reload(!0)}),void o(".fa-lock").click(function(){o(".fa-lock").hide(),e.find(".PreviewTooltip").removeClass("PreviewTooltip"),e.jstree({core:{check_callback:!0,themes:{icons:!1},animation:0},dnd:{copy:!1,large_drop_target:!0,large_drag_target:!0,drag_selection:!0,inside_pos:"last"},plugins:["dnd","wholerow"]}).on("move_node.jstree",function(o,i){i.node.parent&&e.jstree("open_node",i.node.parent);var a=e.data().jstree.get_json(null,{no_state:!0,no_data:!0});return a?(t(a),e.data("sort-timer")&&clearTimeout(e.data("sort-timer")),void e.data("sort-timer",setTimeout(function(){XenForo.ajax(r,{order:a},function(o){console.info("threadmarks updated")})},100))):void console.info("no threadmark data to serialize")}),o(".fa-unlock").show()})):void console.log("No data-sort-url for sortable.")},XenForo.isTouchBrowser()||XenForo.register(".RightPreviewTooltip","XenForo.RightPreviewTooltip"),XenForo.register(".ThreadmarkSortable","XenForo.ThreadmarkSortable")}(jQuery,this,document);
